<!DOCTYPE html>
<html>

<head>
    <title>群聊对话视图</title>
    <style>
        .chat-container {
            width: 600px;
            height: 600px;
            margin: 20px auto;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #f5f5f5;
            overflow-y: auto;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .message {
            margin: 15px 0;
            display: flex;
            flex-direction: column;
        }

        .message-header {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
        }

        .speaker {
            font-weight: 600;
            font-size: 14px;
            margin-right: 8px;
        }

        .time {
            font-size: 12px;
            color: #666;
        }

        .bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 12px;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            word-break: break-word;
            line-height: 1.5;
        }

        .bubble::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border: 8px solid transparent;
            border-right-color: white;
            left: -16px;
            top: 12px;
        }

        /* 不同发言者颜色 */
        .speaker-A {
            color: #e91e63;
        }

        .speaker-B {
            color: #2196f3;
        }

        .speaker-C {
            color: #4caf50;
        }

        .speaker-D {
            color: #9c27b0;
        }

        .speaker-E {
            color: #ff9800;
        }
    </style>
</head>

<body>
    <div id="chat" class="chat-container"></div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // 示例数据
        const messages = [
            {
                "speaker": "B",
                "time": "00:05",
                "content": "可以，我们开始。"
            },
            {
                "speaker": "D",
                "time": "00:08",
                "content": "拆笔记。"
            },
            {
                "speaker": "B",
                "time": "00:10",
                "content": "第一个讨论数据类型。"
            },
            {
                "speaker": "E",
                "time": "00:15",
                "content": "已经开始了。"
            },
            {
                "speaker": "B",
                "time": "00:16",
                "content": "可以开。"
            },
            {
                "speaker": "A",
                "time": "00:16",
                "content": "直接开始。就志伟不是不用了吗？"
            },
            {
                "speaker": "B",
                "time": "00:19",
                "content": "志伟他回来不了。你们觉得有现在有哪几种数据类型？就是我们常见的。"
            },
            {
                "speaker": "E",
                "time": "00:29",
                "content": "分类数据。"
            },
            {
                "speaker": "B",
                "time": "00:29",
                "content": "空间数据说大点声。"
            },
            {
                "speaker": "E",
                "time": "00:32",
                "content": "分类数据、空间数据，时序数据，还有多变量数据。"
            },
            {
                "speaker": "D",
                "time": "00:42",
                "content": "分类数据是什么个定义？"
            },
            {
                "speaker": "E",
                "time": "00:47",
                "content": "就是说按类别分。所以说我们用手机的话是用iphone的还是用安卓的。"
            },
            {
                "speaker": "D",
                "time": "00:54",
                "content": "就是说它有多个类别标签的数据。从数据的特征上，我觉得可以分成。"
            },
            {
                "speaker": "C",
                "time": "01:09",
                "content": "高维。"
            },
            {
                "speaker": "D",
                "time": "01:10",
                "content": "数据，还有比如说时序数据时空数据。"
            },
            {
                "speaker": "D",
                "time": "01:32",
                "content": "那就把什么刚才说过的一些数据类型，我们详细讨论一下它每种类型的一个特点。"
            },
            {
                "speaker": "A",
                "time": "01:47",
                "content": "特点，比方说高维数据的特点可能就是。考出去就是为数很高。所以的话。"
            },
            {
                "speaker": "D",
                "time": "02:02",
                "content": "就是说这个高位数据它比较抽象，不好理解。不像我们二维的一些相关的一些变量比较好理解它的关系。高维数据就有很多个属性值，他们之间的关系很难通过统计普通的统计方法或者说一些图可视化图表进行理解。所以针对这一类数据类型可能要复杂，就是要设计更加针对性的一些图表。比如说一些矩阵或者说是散点图来进行这样的理解和探索，就是它更加复杂。"
            },
            {
                "speaker": "E",
                "time": "02:48",
                "content": "然后时序数据的特点就是它是随着时间变化。源源不断的有数据语言进行的，然后时空数据是具有地理位置形状之类的一些特征。"
            },
            {
                "speaker": "D",
                "time": "03:19",
                "content": "可能按照这个数据的组织结构来说，可以还有比如说图数据。图数据是一类比较特殊的数据，它主要描述的是各个对象以及各个对象之间的关系。然后图数据的话一般会用一些特殊的数据结构来进行表示。比如说表还有这样的临接表，以及一些相关的数据结构。然后图数据也是比较抽象的一类数据，也会有专门的一些方法进行展示和探索。"
            },
            {
                "speaker": "B",
                "time": "04:26",
                "content": "时间还没到吗？再讨论。你们觉得这数据从哪里来的？不会就是说哪些论文有一些数据，或者说这些数据一般在哪边会比较常见。"
            },
            {
                "speaker": "A",
                "time": "04:40",
                "content": "图数据的话，比方说那种就是。"
            },
            {
                "speaker": "A",
                "time": "04:47",
                "content": "他那个事件用，比方说就足球篮球这种运体育运动的话，那种每个每个运动员的每个运动员的信息，还有那个球的信息就可以比较适合用图数据来重复。然后用图图数据存储的话，也比较适合接下来进一步对这个数据的分析。比方说足球里面他还有些预测，就是预测接下来的传球或者是某些关键的球员以及节点。他可能会用到那个GN图神经网络，然后他采用的数据就是这种图图结构的数据。这种比较图书也比较适合展示这种空间位置。"
            },
            {
                "speaker": "E",
                "time": "05:43",
                "content": "像持续数据的话，就是比如像股票，然后每时每刻进行它的一个预测，就是股票价格的预测。然后根据时间的变化或者是。或者是。"
            },
            {
                "speaker": "D",
                "time": "06:06",
                "content": "就是可能还有。"
            },
            {
                "speaker": "D",
                "time": "06:08",
                "content": "实际的一些传感器的一些数据收集，它也是这种连续或者说是流失的一些数据。它也是失去的。对。然后还有一些比如说图数据，它也有一些动态图的数据。它是比如说我在一段时间内这个邮件的收发往来，还有一些社交媒体上的这种互动，它也是属于时序数据，它是有时间的标签的。"
            },
            {
                "speaker": "A",
                "time": "06:41",
                "content": "实时数据的话还有一个就是游戏里面实际数据也比较多。游戏里面的话因为都是那些数据是随着时间的进行而产生的，所以也可以考虑把实际数据给把时间这个属性给考虑进来，就产生的这种数据。"
            },
            {
                "speaker": "E",
                "time": "07:01",
                "content": "时空数据的话就比如地地图或者是我们GPS导航到一个位置。然后中间的这些路径，每时每刻的路径变化，这些应该都是都可能可以产生时空时空。"
            },
            {
                "speaker": "D",
                "time": "07:19",
                "content": "地理。"
            },
            {
                "speaker": "E",
                "time": "07:20",
                "content": "空间的数据。"
            },
            {
                "speaker": "B",
                "time": "07:33",
                "content": "那一般他们的数据的这个展示形式是一般什么？一般都是表格吗？还有还会有一其他格式。比如说地理空间数据的转型是和时空数据转型它会是一样的吗？时间数实际数据的展现不是一样。"
            },
            {
                "speaker": "D",
                "time": "07:55",
                "content": "一般来说静态的数据它的展示以及它的可视化是相对于动态数据来说是要比较简单和频繁的。对于一些动态的数据，可能就牵扯到这个时间上的一个变化，以及对用户对于时间变化的一个感知。所以在设计图表上可能会更加的复杂。然后静态的数据的，实际上现在人们对于动态数据的这个展示，也是从静态数据出发，就是基于静态数据的一个改进来得到的。就比如说静态的一些高维数据、图数据，还有前面说的一些空间的数据，就是三维的这种数据。他们一般都是就比如说图数据的话，就可能使用矩阵或者说是节点链接图来进行布局和展示。高位数据的话就可能使用多举多视图矩阵散点图以及平行坐标之类的静态的图表来进行展示。"
            },
            {
                "speaker": "D",
                "time": "09:19",
                "content": "但是对于动态的，就是对于有时间属性的这些数据，他们可能又会有一些新的展示形式。例如动基于动画的形式，就是在前面的图表的基础上加入一个时间轴，让这些图表运动起来。还有一种形式就是多视图的展，就是叫做small mult的一个展示方式。就是将多个相当于将将多个时间片的这个图标给它并列的排列在一起。然后一张张小的图进行一个动态时间的一个展示。然后这个就是现在基本上两种基于静态图表改进为动态图表的方式。然后这就是这些。数据展示方面的一些基本上就基本的一些区别。"
            },
            {
                "speaker": "B",
                "time": "10:19",
                "content": "其实就是不同的数据类型，他们的数据格式，数据展示方式基本上都是应该会不相同的对吧？"
            },
            {
                "speaker": "D",
                "time": "10:28",
                "content": "是的，行。"
            },
            {
                "speaker": "B",
                "time": "10:30",
                "content": "那这个就先到这。"
            }
        ]

        // 创建对话容器
        const chat = d3.select("#chat");

        // 绘制消息
        const messageGroups = chat.selectAll(".message")
            .data(messages)
            .enter()
            .append("div")
            .attr("class", "message");

        // 消息头部
        const headers = messageGroups.append("div")
            .attr("class", "message-header");

        headers.append("span")
            .attr("class", d => `speaker speaker-${d.speaker}`)
            .text(d => `参与者 ${d.speaker}`);

        headers.append("span")
            .attr("class", "time")
            .text(d => d.time);

        // 消息内容气泡
        messageGroups.append("div")
            .attr("class", "bubble")
            .html(d => formatContent(d.content))
            .on("mouseover", function () {
                d3.select(this).style("transform", "translateX(5px)");
            })
            .on("mouseout", function () {
                d3.select(this).style("transform", "none");
            });

        // 格式化内容（自动分段）
        function formatContent(text) {
            // 按句号分段落
            const sentences = text.split(/[。；]/g).filter(Boolean);
            return sentences.map(s => `<p>${s}。</p>`).join("");
        }

        // 自动滚动到底部
        chat.node().scrollTop = chat.node().scrollHeight;
    </script>
</body>

</html>